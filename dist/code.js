var __awaiter=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(a,o){function m(e){try{_(n.next(e))}catch(e){o(e)}}function l(e){try{_(n.throw(e))}catch(e){o(e)}}function _(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(m,l)}_((n=n.apply(e,t||[])).next())})};let config={};const selection=figma.currentPage.selection[0];if(1===figma.currentPage.selection.length)if("FRAME"===selection.type){let e=figma.currentPage.selection[0].width,t=figma.currentPage.selection[0].height,i=0;for(const n of Object.keys(figma.currentPage.selection[0].children)){if(console.log(n),"GROUP"===selection.children[n].type){i++;let a=selection.children[n],o=a.name;config[o+"_"+i]={title:o,item_type:"ITEM_TYPE.single",items:{}};let m=0;for(const n of a.children)if("INSTANCE"===n.type){console.log("node Instance selected"),console.log(n),m++;let a=n.name;console.log(a),config[o+"_"+i].items[a+"_"+m]={title:a,items:{}},"multisensor"===n.mainComponent.name&&(console.log(n.x),config[o+"_"+i].items[a+"_"+m].item_type="ITEM_TYPE.single",config[o+"_"+i].items[a+"_"+m].param_type="PARAM_TYPE.value",config[o+"_"+i].items[a+"_"+m].custom_data={template:"multisensorTemplate",top:n.y/t*100,left:n.x/e*100,placement:"auto"},config[o+"_"+i].items[a+"_"+m].items={temperature:{title:"Temperature"},humidity:{title:"Humidity"},noise:{title:"Noise"},co2:{title:"CO2"},lighting:{title:"Lighting"}}),"reedswitch"===n.mainComponent.name&&(config[o+"_"+i].items[a+"_"+m].item_type="ITEM_TYPE.single",config[o+"_"+i].items[a+"_"+m].param_type="PARAM_TYPE.signal",config[o+"_"+i].items[a+"_"+m].custom_data={template:"reedSwitchTemplate",top:n.y/t*100,left:n.x/e*100,placement:"auto"},config[o+"_"+i].items[a+"_"+m].items={reed_switch:{title:"Reed switch"}}),"door"===n.mainComponent.name&&(config[o+"_"+i].items[a+"_"+m].item_type="ITEM_TYPE.single",config[o+"_"+i].items[a+"_"+m].param_type="PARAM_TYPE.signal",config[o+"_"+i].items[a+"_"+m].custom_data={template:"doorStateTemplate",top:n.y/t*100,left:n.x/e*100,placement:"auto"},config[o+"_"+i].items[a+"_"+m].items={door_reed_switch:{title:"Door state"}}),"mnemoscheme/switch"===n.mainComponent.parent.name&&(config[o+"_"+i].items[a+"_"+m].item_type="ITEM_TYPE.single",config[o+"_"+i].items[a+"_"+m].param_type="PARAM_TYPE.signal",config[o+"_"+i].items[a+"_"+m].custom_data={template:"mnemonicSwitchTemplate",top:n.y/t*100,left:n.x/e*100,width:n.width,rotation_angle:n.rotation,placement:"auto"},config[o+"_"+i].items[a+"_"+m].items={mnemoscheme_switch:{title:"Mnemoscheme switch state"}}),"camera"===n.mainComponent.name&&(config[o+"_"+i].items[a+"_"+m].item_type="ITEM_TYPE.single",config[o+"_"+i].items[a+"_"+m].param_type="PARAM_TYPE.value",config[o+"_"+i].items[a+"_"+m].custom_data={template:"cameraTemplate",top:n.y/t*100,left:n.x/e*100,placement:"auto",direction:0},config[o+"_"+i].items[a+"_"+m].items={channel:{title:"Channel",item_type:"ITEM_TYPE.single",param_type:"PARAM_TYPE.value"},alarm_state:{title:"Alarm state",item_type:"ITEM_TYPE.single",param_type:"PARAM_TYPE.signal"},work_state:{title:"Work state",item_type:"ITEM_TYPE.single",param_type:"PARAM_TYPE.signal"},detect_mask:{title:"Detect mask",item_type:"ITEM_TYPE.single",param_type:"PARAM_TYPE.increment"},detect_group:{title:"Detect applicant and student meeting",item_type:"ITEM_TYPE.single",param_type:"PARAM_TYPE.increment"}}),"lightline"===n.mainComponent.name&&(config[o+"_"+i].items[a+"_"+m].item_type="ITEM_TYPE.single",config[o+"_"+i].items[a+"_"+m].param_type="PARAM_TYPE.signal",config[o+"_"+i].items[a+"_"+m].custom_data={template:"lightLineTemplate",top:n.y/t*100,left:n.x/e*100,length:n.height/t*100,rotation_angle:n.rotation,placement:"auto"},config[o+"_"+i].items[a+"_"+m].items={light_line:{title:"Light line"}}),"fancoil"===n.mainComponent.name&&(config[o+"_"+i].items[a+"_"+m].item_type="ITEM_TYPE.single",config[o+"_"+i].items[a+"_"+m].param_type="PARAM_TYPE.signal",config[o+"_"+i].items[a+"_"+m].custom_data={template:"fancoilTemplate",top:n.y/t*100,left:n.x/e*100,placement:"auto"},config[o+"_"+i].items[a+"_"+m].items={speed:{title:"Blowing speed",item_type:"ITEM_TYPE.single",param_type:"PARAM_TYPE.value"},operating_mode:{title:"Operating mode",item_type:"ITEM_TYPE.single",param_type:"PARAM_TYPE.value"},control_flag:{title:"Control flag",item_type:"ITEM_TYPE.single",param_type:"PARAM_TYPE.value"}}),"ventilation"===n.mainComponent.name&&(config[o+"_"+i].items[a+"_"+m].item_type="ITEM_TYPE.single",config[o+"_"+i].items[a+"_"+m].param_type="PARAM_TYPE.signal",config[o+"_"+i].items[a+"_"+m].custom_data={template:"ventilationTemplate",top:n.y/t*100,left:n.x/e*100,placement:"auto"},config[o+"_"+i].items[a+"_"+m].items={mode:{title:"Work mode on/off"},error_code:{title:"Error code",item_type:"ITEM_TYPE.single",param_type:"PARAM_TYPE.value"},filter_contamination:{title:"Filter contamination",item_type:"ITEM_TYPE.single",param_type:"PARAM_TYPE.value"},rotation_speed:{title:"Rotation speed",item_type:"ITEM_TYPE.single",param_type:"PARAM_TYPE.value"},temperature_in_channel:{title:"Temperature in channel",item_type:"ITEM_TYPE.single",param_type:"PARAM_TYPE.value"}})}}console.log(config),console.log(JSON.stringify(config))}}else figma.notify("Selection is not a frame. Please select one frame."),figma.closePlugin();else figma.notify("Please select only one frame to run plugin."),figma.closePlugin();const activateUtilitiesUi=()=>{figma.showUI(__html__,{visible:!1})};"export"===figma.command&&(activateUtilitiesUi(),figma.ui.postMessage({command:"export",data:{filename:"plan_configuration.json",data:JSON.stringify(config)}})),"help"===figma.command&&(activateUtilitiesUi(),figma.ui.postMessage({command:"help"})),figma.ui.onmessage=(e=>__awaiter(this,void 0,void 0,function*(){"closePlugin"===e.command&&(void 0!==e.notification&&""!==e.notification&&figma.notify(e.notification),figma.closePlugin())}));